<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunteer Manager</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --slate-1: #fcfcfd;
            --slate-2: #f9f9fb;
            --slate-3: #f0f0f3;
            --slate-4: #e8e8ec;
            --slate-6: #d9d9e0;
            --slate-7: #cdced6;
            --slate-8: #b9bbc6;
            --slate-11: #60646c;
            --slate-12: #1c2024;
            
            --surface: #ffffff;
            --border: var(--slate-6);
            --border-hover: var(--slate-7);
            --text-primary: var(--slate-12);
            --text-secondary: var(--slate-11);
            --muted: var(--slate-3);
            --muted-hover: var(--slate-4);
            
            --duration-fast: 150ms;
            --duration-normal: 200ms;
            --duration-slow: 300ms;
            --ease: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

        :focus {
            outline: none;
        }

        :focus-visible {
            outline: 2px solid var(--slate-8);
            outline-offset: 2px;
            border-radius: 8px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--slate-1);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .app {
            max-width: 428px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--surface);
        }

        .header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--surface);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-box {
            width: 40px;
            height: 40px;
            background: var(--text-primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--surface);
            font-weight: 700;
            font-size: 15px;
        }

        .logo-text h1 {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .logo-text p {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .avatar {
            width: 36px;
            height: 36px;
            background: var(--muted);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
        }

        .avatar:hover {
            background: var(--muted-hover);
        }

        .points-section {
            padding: 20px;
            border-bottom: 1px solid var(--border);
        }

        .points-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .points-value {
            font-size: 36px;
            font-weight: 700;
            letter-spacing: -0.03em;
            line-height: 1;
            transition: transform var(--duration-normal) var(--ease-spring);
            display: inline-block;
        }

        .points-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
            margin-top: 4px;
        }

        .streak {
            padding: 8px 12px;
            background: var(--muted);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
        }

        /* Stats Bar - Clean, Non-Interactive */
        .stats-bar {
            display: flex;
            gap: 24px;
            padding: 0 20px 20px;
            justify-content: space-between;
        }

        .stat-item {
            flex: 1;
            text-align: center;
        }

        .stat-item-value {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .stat-item-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .stat-item-bar {
            height: 2px;
            background: var(--slate-6);
            border-radius: 1px;
            margin-top: 8px;
            position: relative;
            overflow: hidden;
        }

        .stat-item-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: var(--text-primary);
            border-radius: 1px;
            transition: width 0.6s var(--ease);
        }

        .content {
            padding: 24px 20px 120px;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .section-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.06em;
            margin-bottom: 16px;
        }

        .task-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease);
            will-change: transform;
        }

        .task-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-2px) scale(1.005);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .task-card:active {
            transform: translateY(0) scale(0.995);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 8px;
        }

        .task-badges {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            background: var(--muted);
            color: var(--text-secondary);
        }

        .badge-high {
            background: #fef2f2;
            color: #991b1b;
        }

        .task-title {
            font-size: 15px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 6px;
            letter-spacing: -0.01em;
        }

        .task-title strong {
            font-weight: 600;
        }

        .task-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .task-footer {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .contact-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--muted);
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .btn {
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            background: var(--text-primary);
            color: var(--surface);
            transition: all var(--duration-fast) var(--ease);
            will-change: transform;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(-100%);
            transition: transform 0.3s var(--ease);
        }

        .btn:hover::before {
            transform: translateX(0);
        }

        .btn:hover {
            background: var(--slate-11);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0) scale(0.97);
        }

        /* Profile Page Styles */
        .profile-hero {
            padding: 32px 20px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(to bottom, var(--surface), var(--slate-1));
        }

        .profile-avatar-large {
            width: 96px;
            height: 96px;
            background: var(--muted);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: 700;
            color: var(--text-secondary);
            margin: 0 auto 16px;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .profile-role {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .profile-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin: 0 -20px;
            padding: 20px;
            background: var(--surface);
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .profile-stat-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .profile-section {
            margin-bottom: 32px;
        }

        .profile-section-header {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .info-card {
            background: var(--muted);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .info-value {
            font-size: 14px;
            font-weight: 600;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .achievement-card {
            background: var(--muted);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all var(--duration-fast) var(--ease);
        }

        .achievement-card:hover {
            background: var(--muted-hover);
            transform: translateY(-2px);
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .achievement-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Task Action Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            display: none;
            animation: fadeIn var(--duration-normal) var(--ease);
            backdrop-filter: blur(2px);
        }

        .modal-overlay.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(100%);
            width: 100%;
            max-width: 428px;
            max-height: 85vh;
            background: var(--surface);
            border-radius: 20px 20px 0 0;
            z-index: 101;
            transition: transform var(--duration-slow) var(--ease-spring);
            display: flex;
            flex-direction: column;
            touch-action: none;
        }

        .modal.active {
            transform: translateX(-50%) translateY(0);
        }

        .modal::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 4px;
            background: var(--slate-6);
            border-radius: 2px;
            transition: width var(--duration-fast) var(--ease);
        }

        .modal.dragging::before {
            width: 60px;
        }

        .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .modal-title {
            font-size: 16px;
            font-weight: 600;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--muted);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all var(--duration-fast) var(--ease);
        }

        .close-btn:hover {
            background: var(--muted-hover);
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .quick-context {
            background: var(--muted);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
        }

        .quick-context:hover {
            background: var(--muted-hover);
        }

        .context-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .context-avatar {
            width: 48px;
            height: 48px;
            background: var(--surface);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .context-info h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 2px;
            letter-spacing: -0.01em;
        }

        .context-role {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .context-expand {
            margin-left: auto;
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .context-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        .context-stat {
            background: var(--surface);
            padding: 10px;
            border-radius: 8px;
        }

        .context-stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .context-stat-value {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: -0.01em;
        }

        .talking-points {
            background: var(--surface);
            padding: 12px;
            border-radius: 8px;
        }

        .talking-points-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .talking-points ul {
            list-style: none;
            padding: 0;
        }

        .talking-points li {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 6px 0;
            padding-left: 18px;
            position: relative;
        }

        .talking-points li::before {
            content: '•';
            position: absolute;
            left: 6px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .template-section {
            margin-bottom: 20px;
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .template-header h4 {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .edit-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
        }

        .edit-btn:hover {
            background: var(--muted);
            border-color: var(--border-hover);
        }

        .template-content {
            background: var(--muted);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
            min-height: 120px;
            position: relative;
        }

        .template-content.editing {
            background: var(--surface);
            border-color: var(--text-primary);
        }

        .template-content textarea {
            width: 100%;
            min-height: 200px;
            border: none;
            background: transparent;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
            resize: vertical;
            outline: none;
        }

        .template-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .quick-add-btn {
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
        }

        .quick-add-btn:hover {
            background: var(--muted);
            border-color: var(--border-hover);
            color: var(--text-primary);
        }

        .char-counter {
            position: absolute;
            bottom: 16px;
            right: 16px;
            font-size: 11px;
            color: var(--text-secondary);
            background: var(--surface);
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }

        .char-counter.warning {
            color: #f59e0b;
        }

        .char-counter.error {
            color: #ef4444;
        }

        .template-tips {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
            font-size: 12px;
            color: #1e40af;
        }

        .template-tips-title {
            font-weight: 600;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .template-tips ul {
            margin: 0;
            padding-left: 16px;
        }

        .template-tips li {
            margin: 4px 0;
        }

        .preview-mode {
            background: var(--muted);
            border-radius: 10px;
            padding: 16px;
            margin-top: 12px;
        }

        .preview-header {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }

        .preview-content {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
            white-space: pre-wrap;
        }

        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--muted);
            border-color: var(--border-hover);
        }

        .btn-full {
            flex: 1;
        }

        .btn-large {
            padding: 12px 20px;
            font-size: 15px;
        }

        .celebration {
            position: fixed;
            inset: 0;
            background: var(--text-primary);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn var(--duration-normal) var(--ease);
        }

        .celebration.active {
            display: flex;
        }

        .celebration-content {
            text-align: center;
            color: var(--surface);
            animation: celebrationPop 500ms var(--ease-spring);
        }

        @keyframes celebrationPop {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .celebration-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .celebration-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .celebration-points {
            font-size: 40px;
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        /* Onboarding Overlay */
        .onboarding-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 300;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn var(--duration-normal) var(--ease);
        }

        .onboarding-overlay.active {
            display: flex;
        }

        .onboarding-card {
            background: var(--surface);
            border-radius: 20px;
            max-width: 360px;
            width: 90%;
            padding: 32px 24px;
            text-align: center;
            animation: slideUpScale 0.4s var(--ease-spring);
        }

        @keyframes slideUpScale {
            0% {
                opacity: 0;
                transform: translateY(40px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .onboarding-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .onboarding-title {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .onboarding-text {
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .onboarding-steps {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 24px;
            text-align: left;
        }

        .onboarding-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: var(--muted);
            border-radius: 10px;
        }

        .onboarding-step-number {
            width: 32px;
            height: 32px;
            background: var(--text-primary);
            color: var(--surface);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            flex-shrink: 0;
        }

        .onboarding-step-text {
            flex: 1;
            padding-top: 4px;
        }

        .onboarding-step-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .onboarding-step-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .onboarding-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 24px;
        }

        .onboarding-dot {
            width: 8px;
            height: 8px;
            background: var(--slate-6);
            border-radius: 50%;
            transition: all var(--duration-fast) var(--ease);
        }

        .onboarding-dot.active {
            width: 24px;
            background: var(--text-primary);
            border-radius: 4px;
        }

        .onboarding-actions {
            display: flex;
            gap: 12px;
        }

        .btn-skip {
            background: transparent;
            color: var(--text-secondary);
            border: none;
        }

        .btn-skip:hover {
            background: var(--muted);
            color: var(--text-primary);
        }

        /* Help Button */
        .help-button {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: var(--text-primary);
            color: var(--surface);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all var(--duration-fast) var(--ease);
            z-index: 25;
        }

        .help-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .help-button:active {
            transform: scale(0.95);
        }

        /* Help Panel */
        .help-panel {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(100%);
            width: 100%;
            max-width: 428px;
            max-height: 85vh;
            background: var(--surface);
            border-radius: 20px 20px 0 0;
            z-index: 101;
            transition: transform var(--duration-slow) var(--ease-spring);
            display: flex;
            flex-direction: column;
            box-shadow: 0 -4px 24px rgba(0, 0, 0, 0.1);
        }

        .help-panel.active {
            transform: translateX(-50%) translateY(0);
        }

        .help-search {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }

        .help-search input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            background: var(--muted);
            transition: all var(--duration-fast) var(--ease);
        }

        .help-search input:focus {
            outline: none;
            border-color: var(--text-primary);
            background: var(--surface);
        }

        .help-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .help-category {
            margin-bottom: 24px;
        }

        .help-category-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }

        .help-article {
            background: var(--muted);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
        }

        .help-article:hover {
            background: var(--muted-hover);
            transform: translateX(4px);
        }

        .help-article-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .help-article-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .help-article-full {
            display: none;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .help-article-full.active {
            display: block;
        }

        .help-article-body {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .help-article-body h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 12px 0 8px;
        }

        .help-article-body ul {
            margin: 8px 0;
            padding-left: 20px;
        }

        .help-article-body li {
            margin: 4px 0;
        }

        .nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 428px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border);
            display: flex;
            padding: 8px 0 24px;
            z-index: 20;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease);
            position: relative;
        }

        .nav-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) scaleX(0);
            width: 32px;
            height: 2px;
            background: var(--text-primary);
            border-radius: 2px;
            transition: transform var(--duration-normal) var(--ease);
        }

        .nav-item.active {
            color: var(--text-primary);
        }

        .nav-item.active::after {
            transform: translateX(-50%) scaleX(1);
        }

        .nav-item:hover {
            color: var(--text-primary);
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            width: 24px;
            height: 24px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <div class="logo">
                <div class="logo-box">VM</div>
                <div class="logo-text">
                    <h1>Volunteer Manager</h1>
                    <p>Make an impact</p>
                </div>
            </div>
            <div class="avatar" onclick="switchPage('profile')">JD</div>
        </div>

        <!-- Tasks Page -->
        <div id="tasksPage" class="page active">
            <div class="points-section">
                <div class="points-display">
                    <div>
                        <div class="points-value" id="pointsValue">245</div>
                        <div class="points-label">Total Points</div>
                    </div>
                    <div class="streak">🔥 7 day streak</div>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-item-value" id="completedValue">12</div>
                    <div class="stat-item-label">Completed</div>
                    <div class="stat-item-bar">
                        <div class="stat-item-progress" style="width: 48%;"></div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-item-value" id="weekValue">8</div>
                    <div class="stat-item-label">This Week</div>
                    <div class="stat-item-bar">
                        <div class="stat-item-progress" style="width: 80%;"></div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-item-value">3rd</div>
                    <div class="stat-item-label">Rank</div>
                    <div class="stat-item-bar">
                        <div class="stat-item-progress" style="width: 65%;"></div>
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="section-title">Your Tasks</div>

                <div class="task-card" onclick="openTask('susan', 'email')">
                    <div class="task-header">
                        <div class="task-badges">
                            <span class="badge badge-high">HIGH</span>
                            <span class="badge">Thank You</span>
                        </div>
                        <span class="badge">+15 pts</span>
                    </div>
                    <div class="task-title"><strong>Thank</strong> <strong>Susan Martinez</strong> for her $400 donation 💝</div>
                    <div class="task-desc">Major Gift • Yesterday</div>
                    <div class="task-footer">
                        <span class="contact-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="4" width="20" height="16" rx="2"/>
                                <path d="m2 7 10 7 10-7"/>
                            </svg>
                            Email
                        </span>
                    </div>
                </div>

                <div class="task-card" onclick="openTask('robert', 'call')">
                    <div class="task-header">
                        <div class="task-badges">
                            <span class="badge">MEDIUM</span>
                            <span class="badge">Follow-up</span>
                        </div>
                        <span class="badge">+10 pts</span>
                    </div>
                    <div class="task-title"><strong>Ask</strong> <strong>Robert Ross</strong> to support two more named trees</div>
                    <div class="task-desc">Campaign: Spring Planting</div>
                    <div class="task-footer">
                        <span class="contact-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                            </svg>
                            Call
                        </span>
                    </div>
                </div>

                <div class="task-card" onclick="openTask('katherine', 'email')">
                    <div class="task-header">
                        <div class="task-badges">
                            <span class="badge">MEDIUM</span>
                            <span class="badge">Thank You</span>
                        </div>
                        <span class="badge">+12 pts</span>
                    </div>
                    <div class="task-title"><strong>Thank</strong> <strong>Katherine Chen</strong> for her first gift of $250</div>
                    <div class="task-desc">New Donor • 2 days ago</div>
                    <div class="task-footer">
                        <span class="contact-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="4" width="20" height="16" rx="2"/>
                                <path d="m2 7 10 7 10-7"/>
                            </svg>
                            Email
                        </span>
                    </div>
                </div>

                <div class="task-card" onclick="openTask('jessica', 'call')">
                    <div class="task-header">
                        <div class="task-badges">
                            <span class="badge badge-high">HIGH</span>
                            <span class="badge">Follow-up</span>
                        </div>
                        <span class="badge">+15 pts</span>
                    </div>
                    <div class="task-title"><strong>Follow up with</strong> <strong>Jessica Thompson</strong> who clicked donation link</div>
                    <div class="task-desc">Campaign: Annual Fund</div>
                    <div class="task-footer">
                        <span class="contact-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                            </svg>
                            Call
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rewards Page -->
        <div id="rewardsPage" class="page">
            <div class="content" style="padding-top: 24px;">
                <div class="section-title">Available Rewards</div>

                <div style="background: var(--muted); border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-size: 13px; color: var(--text-secondary); font-weight: 500;">Your Points</span>
                        <span style="font-size: 24px; font-weight: 700; color: var(--text-primary);" id="rewardsPoints">245</span>
                    </div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Next reward unlocks at 300 points</div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">🎯 Milestones</h3>
                    
                    <div class="info-card" style="background: linear-gradient(135deg, #eff6ff, #dbeafe); border: 1px solid #bfdbfe; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: #1e40af; margin-bottom: 4px;">First 10 Tasks</div>
                                <div style="font-size: 13px; color: #3b82f6;">✓ Unlocked • Certificate earned</div>
                            </div>
                            <div style="font-size: 32px;">🎯</div>
                        </div>
                    </div>

                    <div class="info-card" style="background: linear-gradient(135deg, #eff6ff, #dbeafe); border: 1px solid #bfdbfe; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: #1e40af; margin-bottom: 4px;">7 Day Streak</div>
                                <div style="font-size: 13px; color: #3b82f6;">✓ Unlocked • Keep it going!</div>
                            </div>
                            <div style="font-size: 32px;">🔥</div>
                        </div>
                    </div>

                    <div class="info-card" style="opacity: 0.6; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">Top 3 Rank</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Reach top 3 on leaderboard • 50 pts bonus</div>
                            </div>
                            <div style="font-size: 32px;">🏆</div>
                        </div>
                    </div>

                    <div class="info-card" style="opacity: 0.6; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">25 Tasks Completed</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">13 more to go • Recognition badge</div>
                            </div>
                            <div style="font-size: 32px;">⭐</div>
                        </div>
                    </div>

                    <div class="info-card" style="opacity: 0.6;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">50 Tasks Completed</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">38 more to go • Elite volunteer status</div>
                            </div>
                            <div style="font-size: 32px;">💎</div>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">🎁 Perks Unlocked</h3>
                    
                    <div class="info-card" style="margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="font-size: 28px;">✍️</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Template Editing</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">Personalize your messages</div>
                            </div>
                            <div style="padding: 4px 8px; background: #dcfce7; color: #166534; border-radius: 6px; font-size: 11px; font-weight: 600;">ACTIVE</div>
                        </div>
                    </div>

                    <div class="info-card" style="margin-bottom: 12px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="font-size: 28px;">📊</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Advanced Stats</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">See your impact metrics</div>
                            </div>
                            <div style="padding: 4px 8px; background: #dcfce7; color: #166534; border-radius: 6px; font-size: 11px; font-weight: 600;">ACTIVE</div>
                        </div>
                    </div>

                    <div class="info-card" style="opacity: 0.6;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="font-size: 28px;">🎨</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Profile Themes</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">Unlocks at 300 points</div>
                            </div>
                            <div style="padding: 4px 8px; background: var(--muted); color: var(--text-secondary); border-radius: 6px; font-size: 11px; font-weight: 600;">LOCKED</div>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">🏅 Recognition</h3>
                    
                    <div class="info-card">
                        <div style="text-align: center; padding: 16px;">
                            <div style="font-size: 48px; margin-bottom: 12px;">📜</div>
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Download Certificate</div>
                            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 16px;">Share your volunteer impact</div>
                            <button class="btn" style="width: 100%;">Generate Certificate</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Page -->
        <div id="leaderboardPage" class="page">
            <div class="content" style="padding-top: 24px;">
                <div class="section-title">This Week's Leaders</div>

                <div style="background: linear-gradient(135deg, #fef3c7, #fde68a); border: 1px solid #fbbf24; border-radius: 12px; padding: 20px; margin-bottom: 24px; text-align: center;">
                    <div style="font-size: 13px; font-weight: 600; color: #78350f; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px;">Your Rank</div>
                    <div style="font-size: 48px; font-weight: 700; color: #78350f; margin-bottom: 4px;">#3</div>
                    <div style="font-size: 14px; color: #92400e;">245 points • 8 tasks this week</div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">Top Volunteers</h3>
                    
                    <!-- 1st Place -->
                    <div class="info-card" style="background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #fbbf24; margin-bottom: 12px; position: relative;">
                        <div style="position: absolute; top: -8px; right: 12px; background: #fbbf24; color: #78350f; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 700;">👑 1ST</div>
                        <div style="display: flex; align-items: center; gap: 12px; padding-top: 8px;">
                            <div style="width: 48px; height: 48px; background: #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; color: white; flex-shrink: 0;">MJ</div>
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: #78350f; margin-bottom: 2px;">Michael Johnson</div>
                                <div style="font-size: 13px; color: #92400e;">15 tasks • 420 points</div>
                            </div>
                        </div>
                    </div>

                    <!-- 2nd Place -->
                    <div class="info-card" style="background: linear-gradient(135deg, #f3f4f6, #e5e7eb); border: 2px solid #d1d5db; margin-bottom: 12px; position: relative;">
                        <div style="position: absolute; top: -8px; right: 12px; background: #d1d5db; color: #374151; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 700;">🥈 2ND</div>
                        <div style="display: flex; align-items: center; gap: 12px; padding-top: 8px;">
                            <div style="width: 48px; height: 48px; background: #9ca3af; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; color: white; flex-shrink: 0;">SW</div>
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: #374151; margin-bottom: 2px;">Sarah Williams</div>
                                <div style="font-size: 13px; color: #6b7280;">12 tasks • 315 points</div>
                            </div>
                        </div>
                    </div>

                    <!-- 3rd Place (You) -->
                    <div class="info-card" style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border: 2px solid #fca5a5; margin-bottom: 12px; position: relative;">
                        <div style="position: absolute; top: -8px; right: 12px; background: #fca5a5; color: #7f1d1d; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 700;">🥉 3RD</div>
                        <div style="display: flex; align-items: center; gap: 12px; padding-top: 8px;">
                            <div style="width: 48px; height: 48px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; color: var(--text-secondary); flex-shrink: 0; border: 2px solid #fca5a5;">JD</div>
                            <div style="flex: 1;">
                                <div style="font-size: 15px; font-weight: 600; color: #7f1d1d; margin-bottom: 2px;">Jane Doe (You)</div>
                                <div style="font-size: 13px; color: #991b1b;">8 tasks • 245 points</div>
                            </div>
                        </div>
                    </div>

                    <!-- 4th-10th Place -->
                    <div class="info-card" style="margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 32px; text-align: center; font-weight: 700; color: var(--text-secondary); flex-shrink: 0;">4</div>
                            <div style="width: 40px; height: 40px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: var(--text-secondary); flex-shrink: 0;">DL</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">David Lee</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">7 tasks • 210 points</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-card" style="margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 32px; text-align: center; font-weight: 700; color: var(--text-secondary); flex-shrink: 0;">5</div>
                            <div style="width: 40px; height: 40px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: var(--text-secondary); flex-shrink: 0;">EM</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Emily Martinez</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">6 tasks • 180 points</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-card" style="margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 32px; text-align: center; font-weight: 700; color: var(--text-secondary); flex-shrink: 0;">6</div>
                            <div style="width: 40px; height: 40px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: var(--text-secondary); flex-shrink: 0;">RB</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Robert Brown</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">5 tasks • 165 points</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-card" style="margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 32px; text-align: center; font-weight: 700; color: var(--text-secondary); flex-shrink: 0;">7</div>
                            <div style="width: 40px; height: 40px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: var(--text-secondary); flex-shrink: 0;">LT</div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 2px;">Lisa Taylor</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">5 tasks • 155 points</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; padding: 24px 0;">
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 8px;">Need 70 more points to reach #2</div>
                    <button class="btn" onclick="switchPage('tasks')">Complete More Tasks</button>
                </div>
            </div>
        </div>
            <div class="profile-hero">
                <div class="profile-avatar-large">JD</div>
                <h2 class="profile-name">Jane Doe</h2>
                <p class="profile-role">Volunteer • Class of 2015</p>
            </div>

            <div class="profile-stats-grid">
                <div class="profile-stat">
                    <div class="profile-stat-value">245</div>
                    <div class="profile-stat-label">Points</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value">12</div>
                    <div class="profile-stat-label">Tasks</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value">7</div>
                    <div class="profile-stat-label">Streak</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value">3rd</div>
                    <div class="profile-stat-label">Rank</div>
                </div>
            </div>

            <div class="content">
                <div class="profile-section">
                    <h3 class="profile-section-header">My Information</h3>
                    <div class="info-card">
                        <div class="info-row">
                            <span class="info-label">Email</span>
                            <span class="info-value">jane.doe@email.com</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Phone</span>
                            <span class="info-value">(415) 555-0100</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Member Since</span>
                            <span class="info-value">Sept 2025</span>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">Achievements</h3>
                    <div class="achievement-grid">
                        <div class="achievement-card">
                            <div class="achievement-icon">🎯</div>
                            <div class="achievement-label">First Task</div>
                        </div>
                        <div class="achievement-card">
                            <div class="achievement-icon">🔥</div>
                            <div class="achievement-label">7 Day Streak</div>
                        </div>
                        <div class="achievement-card">
                            <div class="achievement-icon">⭐</div>
                            <div class="achievement-label">10 Tasks</div>
                        </div>
                        <div class="achievement-card" style="opacity: 0.4;">
                            <div class="achievement-icon">💎</div>
                            <div class="achievement-label">Top 3</div>
                        </div>
                        <div class="achievement-card" style="opacity: 0.4;">
                            <div class="achievement-icon">🏆</div>
                            <div class="achievement-label">50 Tasks</div>
                        </div>
                        <div class="achievement-card" style="opacity: 0.4;">
                            <div class="achievement-icon">👑</div>
                            <div class="achievement-label">Leaderboard #1</div>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">Impact Summary</h3>
                    <div class="info-card">
                        <div class="info-row">
                            <span class="info-label">Emails Sent</span>
                            <span class="info-value">8</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Calls Made</span>
                            <span class="info-value">4</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Donations Influenced</span>
                            <span class="info-value">$2,450</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Response Rate</span>
                            <span class="info-value">75%</span>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">Preferences</h3>
                    <div class="info-card">
                        <div class="info-row">
                            <span class="info-label">Notifications</span>
                            <span class="info-value">Email + Push</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Task Assignments</span>
                            <span class="info-value">Auto-assign</span>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h3 class="profile-section-header">Help & Support</h3>
                    <div class="info-card">
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <button class="btn btn-secondary" style="width: 100%;" onclick="toggleHelp()">📚 Browse Help Articles</button>
                            <button class="btn btn-secondary" style="width: 100%;" onclick="startOnboarding()">🎯 Retake Tour</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="nav">
            <div class="nav-item active" onclick="switchPage('tasks')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"/>
                    <path d="M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v0a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2z"/>
                </svg>
                <span class="nav-label">Tasks</span>
            </div>
            <div class="nav-item" onclick="switchPage('rewards')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="8" r="6"/>
                    <path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/>
                </svg>
                <span class="nav-label">Rewards</span>
            </div>
            <div class="nav-item" onclick="switchPage('leaderboard')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18"/>
                    <path d="M18 17V9"/>
                    <path d="M13 17V5"/>
                    <path d="M8 17v-3"/>
                </svg>
                <span class="nav-label">Leaderboard</span>
            </div>
            <div class="nav-item" onclick="switchPage('profile')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="8" r="5"/>
                    <path d="M20 21a8 8 0 1 0-16 0"/>
                </svg>
                <span class="nav-label">Profile</span>
            </div>
        </div>
    </div>

    <!-- Task Action Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()">
        <div class="modal" id="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Task</h2>
                <button class="close-btn" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer" id="modalFooter"></div>
        </div>
    </div>

    <!-- Celebration -->
    <div class="celebration" id="celebration">
        <div class="celebration-content">
            <div class="celebration-icon">🎉</div>
            <div class="celebration-title">Task Complete!</div>
            <div class="celebration-points" id="celebrationPoints">+15 points</div>
        </div>
    </div>

    <!-- Onboarding -->
    <div class="onboarding-overlay" id="onboardingOverlay">
        <div class="onboarding-card" id="onboardingCard">
            <!-- Content loaded dynamically -->
        </div>
    </div>

    <!-- Help Button -->
    <button class="help-button" id="helpButton" onclick="toggleHelp()">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <path d="M12 17h.01"/>
        </svg>
    </button>

    <!-- Help Panel -->
    <div class="modal-overlay" id="helpOverlay" onclick="toggleHelp()"></div>
    <div class="help-panel" id="helpPanel" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2 class="modal-title">Help & Support</h2>
            <button class="close-btn" onclick="toggleHelp()">×</button>
        </div>
        <div class="help-search">
            <input type="text" placeholder="Search help articles..." id="helpSearch" oninput="filterHelpArticles(this.value)">
        </div>
        <div class="help-content" id="helpContent">
            <!-- Content loaded dynamically -->
        </div>
    </div>

    <script>
        const taskData = {
            susan: {
                name: 'Susan Martinez',
                initials: 'SM',
                role: 'Parent, Class of 2026',
                phone: '(415) 555-0123',
                email: 'susan.martinez@email.com',
                address: '2847 Pacific Ave, San Francisco, CA 94115',
                tags: ['Major Donor', 'Parent', 'Class of 2026'],
                household: {
                    spouse: 'Carlos Martinez',
                    students: ['Sofia Martinez (Class of 2026)', 'Miguel Martinez (Class of 2028)']
                },
                stats: {
                    lifetime: '$12,450',
                    lastGift: '$400 (2 days ago)',
                    avgGift: '$387',
                    lastContact: 'Sep 30 - Thank you email',
                    thisYear: '$2,800'
                },
                giving: [
                    { amount: '$400', date: 'Oct 1, 2025', campaign: 'Annual Fund', designation: 'Unrestricted' },
                    { amount: '$500', date: 'Sep 15, 2025', campaign: 'Fall Appeal', designation: 'Athletics' },
                    { amount: '$1,900', date: 'Mar 20, 2025', campaign: 'Spring Gala', designation: 'Scholarship Fund' }
                ],
                history: [
                    { type: 'Email Sent', date: 'Sep 30, 2025', title: 'Thank you for $500 gift', note: 'Acknowledged fall appeal donation', channel: 'EMAIL' },
                    { type: 'Phone Call', date: 'Sep 16, 2025', title: 'Follow-up on gala attendance', note: 'Confirmed attendance for 2026 gala. Interested in table sponsorship.', channel: 'CALL' },
                    { type: 'Email Opened', date: 'Sep 14, 2025', title: 'Fall Appeal Email', note: 'Clicked donation link, gave $500', channel: 'EMAIL' }
                ],
                preferences: {
                    channel: 'Email preferred, open to calls',
                    timing: 'Weekday mornings (9-11am)',
                    interests: 'Athletics, Scholarship Fund, Capital Projects'
                },
                talkingPoints: [
                    'Very engaged parent, attends most school events',
                    'Interested in library naming opportunity',
                    'Previous major gift to scholarship fund',
                    'Best time to reach: Weekday mornings'
                ],
                emailTemplate: `Dear Susan,

Thank you so much for your generous gift of $400 to our Annual Fund. Your continued support makes a tremendous difference in the lives of our students.

Your dedication to our school community is truly inspiring. Gifts like yours help us provide the exceptional education and opportunities that make our school special.

We're so grateful to have you as part of our family.

With sincere thanks,
[Your Name]`,
                points: 15,
                type: 'email'
            },
            robert: {
                name: 'Robert Ross',
                initials: 'RR',
                role: 'Alumni, Class of 1998',
                phone: '(650) 555-0198',
                email: 'r.ross@techcompany.com',
                address: '1520 Oak Street, Menlo Park, CA 94025',
                tags: ['Alumni', 'Tech Executive', 'Named Tree Donor'],
                household: { spouse: 'Jennifer Ross', students: [] },
                stats: {
                    lifetime: '$8,200',
                    lastGift: '$1,500 (15 days ago)',
                    avgGift: '$410',
                    lastContact: 'Sep 20 - Thank you email',
                    thisYear: '$1,500'
                },
                giving: [
                    { amount: '$750', date: 'Sep 17, 2025', campaign: 'Spring Planting', designation: 'Named Tree #1' },
                    { amount: '$750', date: 'Sep 17, 2025', campaign: 'Spring Planting', designation: 'Named Tree #2' }
                ],
                history: [
                    { type: 'Email Sent', date: 'Sep 20, 2025', title: 'Thank you for named trees', note: 'Acknowledged two named tree donations', channel: 'EMAIL' }
                ],
                preferences: {
                    channel: 'Email only (busy schedule)',
                    timing: 'Early evening (6-7pm)',
                    interests: 'Environmental programs, Campus improvements'
                },
                talkingPoints: [
                    'Tech executive, busy schedule - keep it brief',
                    'Already donated 2 named trees ($1,500 total)',
                    'Passionate about environmental sustainability',
                    'Ask about supporting 2 more trees ($750 each)',
                    'Mention campaign ends in 5 days'
                ],
                emailTemplate: null,
                points: 10,
                type: 'call'
            },
            katherine: {
                name: 'Katherine Chen',
                initials: 'KC',
                role: 'New Parent, Class of 2031',
                phone: '(415) 555-0287',
                email: 'k.chen@lawfirm.com',
                address: '456 Divisadero St, San Francisco, CA 94117',
                tags: ['New Donor', 'Parent', 'First-Time Giver'],
                household: { spouse: 'David Chen', students: ['Emma Chen (Class of 2031)'] },
                stats: {
                    lifetime: '$250',
                    lastGift: '$250 (2 days ago)',
                    avgGift: '$250',
                    lastContact: 'First gift - Oct 1',
                    thisYear: '$250'
                },
                giving: [
                    { amount: '$250', date: 'Sep 30, 2025', campaign: 'Annual Fund', designation: 'Unrestricted' }
                ],
                history: [
                    { type: 'Gift Received', date: 'Sep 30, 2025', title: 'First gift - $250', note: 'New parent welcome appeal response', channel: 'GIFT' }
                ],
                preferences: {
                    channel: 'Email preferred',
                    timing: 'Weekends or evenings',
                    interests: 'General support, Learning about opportunities'
                },
                talkingPoints: [
                    'Brand new donor - first gift ever!',
                    'Very engaged at new parent orientation',
                    'Daughter just started kindergarten',
                    'Make her feel welcomed and appreciated'
                ],
                emailTemplate: `Dear Katherine,

Welcome to our school family! We're thrilled to have Emma in kindergarten this year.

Thank you so much for your first gift of $250 to our Annual Fund. Your support as a new parent means the world to us and helps create the amazing experiences our students enjoy every day.

We're so excited to have you as part of our community and look forward to many wonderful years ahead.

With gratitude and warm welcome,
[Your Name]`,
                points: 12,
                type: 'email'
            },
            jessica: {
                name: 'Jessica Thompson',
                initials: 'JT',
                role: 'Parent, Class of 2027',
                phone: '(415) 555-0345',
                email: 'jessica.thompson@design.co',
                address: '789 Hayes Street, San Francisco, CA 94102',
                tags: ['Parent', 'Lapsed Donor', 'Class of 2027'],
                household: { spouse: 'Michael Thompson', students: ['Olivia Thompson (Class of 2027)'] },
                stats: {
                    lifetime: '$1,850',
                    lastGift: '$450 (8 months ago)',
                    avgGift: '$370',
                    lastContact: 'Oct 2 - Clicked donation link',
                    thisYear: '$0'
                },
                giving: [
                    { amount: '$450', date: 'Jan 25, 2025', campaign: 'Annual Fund', designation: 'Unrestricted' }
                ],
                history: [
                    { type: 'Link Clicked', date: 'Oct 2, 2025', title: 'Annual Fund Email', note: 'Clicked donation link but did not complete gift.', channel: 'EMAIL' }
                ],
                preferences: {
                    channel: 'Phone preferred for follow-up',
                    timing: 'Afternoons (2-4pm)',
                    interests: 'Arts Program, Financial Aid'
                },
                talkingPoints: [
                    'Lapsed donor - gave $450 in January',
                    'Just clicked donation link but didn\'t complete gift',
                    'Hot lead - reach out while interest is fresh',
                    'Prefers supporting Arts Program',
                    'Best time: Afternoons 2-4pm'
                ],
                emailTemplate: null,
                points: 15,
                type: 'call'
            }
        };

        let currentTask = null;
        let isEditing = false;
        let isPreviewing = false;
        let currentTaskId = null;
        let modalDragState = { dragging: false, startY: 0, currentY: 0 };
        let originalTemplate = '';
        let onboardingStep = 0;
        
        const CHAR_LIMIT = 800;
        const CHAR_WARNING = 650;

        // Check if first time user
        window.addEventListener('DOMContentLoaded', () => {
            const hasSeenOnboarding = localStorage.getItem('vm_onboarding_completed');
            if (!hasSeenOnboarding) {
                setTimeout(() => startOnboarding(), 500);
            }
            loadHelpArticles();
        });

        function startOnboarding() {
            onboardingStep = 0;
            showOnboardingStep(0);
            document.getElementById('onboardingOverlay').classList.add('active');
        }

        function showOnboardingStep(step) {
            const card = document.getElementById('onboardingCard');
            
            const steps = [
                // Step 1: Welcome
                {
                    icon: '👋',
                    title: 'Welcome to Volunteer Manager!',
                    text: 'You\'re making a real difference for our school community. Complete quick tasks to thank donors and build lasting relationships.',
                    showSteps: false
                },
                // Step 2: How it works
                {
                    icon: '✨',
                    title: 'How It Works',
                    text: 'Complete tasks in three simple steps:',
                    showSteps: true,
                    steps: [
                        { number: 1, title: 'Pick a Task', desc: 'Choose from your assigned list' },
                        { number: 2, title: 'Send Message', desc: 'Use our templates or personalize' },
                        { number: 3, title: 'Earn Points', desc: 'Track your impact and compete' }
                    ]
                },
                // Step 3: Get started
                {
                    icon: '🚀',
                    title: 'You\'re All Set!',
                    text: 'Most tasks take under 2 minutes. Ready to make your first impact?',
                    showSteps: false
                }
            ];

            const currentStep = steps[step];
            const isLastStep = step === steps.length - 1;

            let html = `
                <div class="onboarding-icon">${currentStep.icon}</div>
                <h2 class="onboarding-title">${currentStep.title}</h2>
                <p class="onboarding-text">${currentStep.text}</p>
            `;

            if (currentStep.showSteps) {
                html += '<div class="onboarding-steps">';
                currentStep.steps.forEach(s => {
                    html += `
                        <div class="onboarding-step">
                            <div class="onboarding-step-number">${s.number}</div>
                            <div class="onboarding-step-text">
                                <div class="onboarding-step-title">${s.title}</div>
                                <div class="onboarding-step-desc">${s.desc}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            html += '<div class="onboarding-dots">';
            steps.forEach((_, i) => {
                html += `<div class="onboarding-dot ${i === step ? 'active' : ''}"></div>`;
            });
            html += '</div>';

            html += '<div class="onboarding-actions">';
            if (!isLastStep) {
                html += '<button class="btn btn-skip btn-full" onclick="skipOnboarding()">Skip</button>';
            }
            html += `<button class="btn btn-full btn-large" onclick="${isLastStep ? 'finishOnboarding()' : 'nextOnboardingStep()'}">
                ${isLastStep ? 'Get Started' : 'Next'}
            </button>`;
            html += '</div>';

            card.innerHTML = html;
        }

        function nextOnboardingStep() {
            onboardingStep++;
            showOnboardingStep(onboardingStep);
            haptic('light');
        }

        function skipOnboarding() {
            finishOnboarding();
        }

        function finishOnboarding() {
            localStorage.setItem('vm_onboarding_completed', 'true');
            document.getElementById('onboardingOverlay').classList.remove('active');
            haptic('medium');
        }
        
        // Volunteer permission system
        const volunteerProfile = {
            tasksCompleted: 12,
            level: 'intermediate', // 'new', 'intermediate', 'advanced'
            canEditTemplates: true, // Unlocked after 5 tasks
            editCount: 3,
            sendWithoutEditCount: 9
        };

        function getVolunteerLevel() {
            const completed = volunteerProfile.tasksCompleted;
            if (completed < 5) return 'new';
            if (completed < 25) return 'intermediate';
            return 'advanced';
        }

        function canEditTemplate(taskType) {
            // New volunteers can't edit for first 5 tasks
            if (volunteerProfile.tasksCompleted < 5) return false;
            
            // Advanced volunteers can edit everything
            if (getVolunteerLevel() === 'advanced') return true;
            
            // Intermediate can edit thank yous but not major asks
            return taskType === 'thankyou';
        }

        // Haptic feedback helper
        function haptic(type = 'light') {
            if ('vibrate' in navigator) {
                const patterns = {
                    light: [5],
                    medium: [10],
                    success: [10, 50, 10]
                };
                navigator.vibrate(patterns[type] || patterns.light);
            }
        }

        // Modal drag gesture
        function setupModalDrag() {
            const modal = document.getElementById('modal');
            if (!modal) return;

            modal.addEventListener('pointerdown', (e) => {
                // Only drag from top 40px of modal
                const rect = modal.getBoundingClientRect();
                if (e.clientY - rect.top > 40) return;
                
                modalDragState.dragging = true;
                modalDragState.startY = e.clientY;
                modal.setPointerCapture(e.pointerId);
                modal.classList.add('dragging');
            });

            modal.addEventListener('pointermove', (e) => {
                if (!modalDragState.dragging) return;
                
                modalDragState.currentY = Math.max(0, e.clientY - modalDragState.startY);
                modal.style.transition = 'none';
                modal.style.transform = `translateX(-50%) translateY(${modalDragState.currentY}px)`;
                
                // Visual feedback at threshold
                if (modalDragState.currentY > 100 && modalDragState.currentY < 105) {
                    haptic('light');
                }
            });

            modal.addEventListener('pointerup', () => {
                if (!modalDragState.dragging) return;
                
                modal.classList.remove('dragging');
                modal.style.transition = '';
                
                if (modalDragState.currentY > 140) {
                    haptic('medium');
                    closeModal();
                } else {
                    modal.style.transform = 'translateX(-50%) translateY(0)';
                }
                
                modalDragState.dragging = false;
                modalDragState.currentY = 0;
            });
        }

        // Tween numbers for smooth counting
        function tweenNumber(element, to, duration = 400) {
            if (!element) return;
            const from = parseInt(element.textContent) || 0;
            const start = performance.now();
            
            function update(timestamp) {
                const progress = Math.min((timestamp - start) / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3); // easeOutCubic
                element.textContent = Math.round(from + (to - from) * eased);
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        function switchPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            if (page === 'tasks') {
                document.getElementById('tasksPage').classList.add('active');
                document.querySelectorAll('.nav-item')[0].classList.add('active');
            } else if (page === 'rewards') {
                document.getElementById('rewardsPage').classList.add('active');
                document.querySelectorAll('.nav-item')[1].classList.add('active');
                // Sync points display
                document.getElementById('rewardsPoints').textContent = document.getElementById('pointsValue').textContent;
            } else if (page === 'leaderboard') {
                document.getElementById('leaderboardPage').classList.add('active');
                document.querySelectorAll('.nav-item')[2].classList.add('active');
            } else if (page === 'profile') {
                document.getElementById('profilePage').classList.add('active');
                document.querySelectorAll('.nav-item')[3].classList.add('active');
            }
            
            haptic('light');
        }

        function openTask(taskId, type) {
            currentTask = taskData[taskId];
            currentTaskId = taskId;
            
            document.getElementById('modalTitle').textContent = 
                type === 'email' ? 'Send Thank You Email' : 'Make Follow-up Call';

            const contextHTML = `
                <div class="quick-context" onclick="event.stopPropagation(); openFullProfile('${taskId}')">
                    <div class="context-header">
                        <div class="context-avatar">${currentTask.initials}</div>
                        <div class="context-info">
                            <h3>${currentTask.name}</h3>
                            <div class="context-role">${currentTask.role}</div>
                        </div>
                        <div class="context-expand">
                            View Full Profile →
                        </div>
                    </div>
                    <div class="context-stats">
                        <div class="context-stat">
                            <div class="context-stat-label">Lifetime</div>
                            <div class="context-stat-value">${currentTask.stats.lifetime}</div>
                        </div>
                        <div class="context-stat">
                            <div class="context-stat-label">Last Gift</div>
                            <div class="context-stat-value">${currentTask.stats.lastGift}</div>
                        </div>
                    </div>
                    <div class="talking-points">
                        <div class="talking-points-title">Key Context</div>
                        <ul>
                            ${currentTask.talkingPoints.slice(0, 3).map(point => `<li>${point}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;

            let bodyHTML = contextHTML;

            if (type === 'email') {
                const canEdit = canEditTemplate('thankyou');
                const editButtonHTML = canEdit 
                    ? `<button class="edit-btn" onclick="toggleEdit()">Edit</button>`
                    : `<button class="edit-btn" disabled style="opacity: 0.5; cursor: not-allowed;" title="Complete 5 tasks to unlock editing">🔒 Locked</button>`;
                
                bodyHTML += `
                    <div class="template-section">
                        <div class="template-header">
                            <h4>Email Template</h4>
                            ${editButtonHTML}
                        </div>
                        <div class="template-content" id="templateContent">
                            ${currentTask.emailTemplate.replace(/\n/g, '<br>')}
                        </div>
                    </div>
                `;
            } else {
                bodyHTML += `
                    <div class="template-section">
                        <div class="template-header">
                            <h4>Talking Points</h4>
                        </div>
                        <div class="talking-points" style="background: var(--muted); padding: 16px; border-radius: 10px;">
                            <ul style="margin-bottom: 0;">
                                ${currentTask.talkingPoints.map(point => `<li>${point}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }

            document.getElementById('modalBody').innerHTML = bodyHTML;

            if (type === 'email') {
                document.getElementById('modalFooter').innerHTML = `
                    <button class="btn btn-secondary btn-full btn-large" onclick="closeModal()">Cancel</button>
                    <button class="btn btn-full btn-large" onclick="completeTask()">Send Email</button>
                `;
            } else {
                document.getElementById('modalFooter').innerHTML = `
                    <button class="btn btn-secondary btn-full btn-large" onclick="closeModal()">Cancel</button>
                    <button class="btn btn-full btn-large" onclick="makeCall()">Call ${currentTask.phone}</button>
                `;
            }

            document.getElementById('modalOverlay').classList.add('active');
            setTimeout(() => {
                document.getElementById('modal').classList.add('active');
                setupModalDrag();
            }, 10);
        }

        function toggleEdit() {
            isEditing = !isEditing;
            isPreviewing = false;
            const content = document.getElementById('templateContent');
            const editBtn = document.querySelector('.edit-btn');

            if (isEditing) {
                originalTemplate = currentTask.emailTemplate;
                const currentText = currentTask.emailTemplate;
                const charCount = currentText.length;
                const counterClass = charCount >= CHAR_LIMIT ? 'error' : charCount >= CHAR_WARNING ? 'warning' : '';
                
                content.innerHTML = `
                    <textarea id="templateTextarea" maxlength="${CHAR_LIMIT}">${currentText}</textarea>
                    <div class="char-counter ${counterClass}" id="charCounter">${charCount}/${CHAR_LIMIT}</div>
                `;
                content.classList.add('editing');
                editBtn.textContent = 'Done';
                
                const textarea = document.getElementById('templateTextarea');
                textarea.focus();
                
                // Update char counter on input
                textarea.addEventListener('input', updateCharCounter);
                
                // Add quick actions
                const actionsHTML = `
                    <div class="template-actions">
                        <button class="quick-add-btn" onclick="addPersonalNote()">+ Add Personal Note</button>
                        <button class="quick-add-btn" onclick="resetTemplate()">Reset to Default</button>
                        <button class="quick-add-btn" onclick="previewTemplate()">Preview</button>
                    </div>
                    <div class="template-tips">
                        <div class="template-tips-title">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4"/>
                                <path d="M12 8h.01"/>
                            </svg>
                            Tips for Great Messages
                        </div>
                        <ul>
                            <li>Add specific details about their gift or involvement</li>
                            <li>Keep it warm but professional</li>
                            <li>Mention impact or next steps if relevant</li>
                        </ul>
                    </div>
                `;
                content.insertAdjacentHTML('afterend', actionsHTML);
                
            } else {
                const textarea = document.getElementById('templateTextarea');
                if (textarea) {
                    currentTask.emailTemplate = textarea.value;
                }
                
                // Remove actions and tips
                document.querySelector('.template-actions')?.remove();
                document.querySelector('.template-tips')?.remove();
                document.querySelector('.preview-mode')?.remove();
                
                content.innerHTML = currentTask.emailTemplate.replace(/\n/g, '<br>');
                content.classList.remove('editing');
                editBtn.textContent = 'Edit';
                
                haptic('light');
            }
        }

        function updateCharCounter() {
            const textarea = document.getElementById('templateTextarea');
            const counter = document.getElementById('charCounter');
            if (!textarea || !counter) return;
            
            const count = textarea.value.length;
            counter.textContent = `${count}/${CHAR_LIMIT}`;
            counter.className = 'char-counter';
            
            if (count >= CHAR_LIMIT) {
                counter.classList.add('error');
            } else if (count >= CHAR_WARNING) {
                counter.classList.add('warning');
            }
        }

        function addPersonalNote() {
            const textarea = document.getElementById('templateTextarea');
            if (!textarea) return;
            
            const cursorPos = textarea.selectionStart;
            const textBefore = textarea.value.substring(0, cursorPos);
            const textAfter = textarea.value.substring(cursorPos);
            
            const noteTemplate = '\n\nP.S. [Add your personal note here]';
            textarea.value = textBefore + noteTemplate + textAfter;
            
            // Select the placeholder text
            const placeholderStart = cursorPos + 6; // After "\n\nP.S. "
            const placeholderEnd = placeholderStart + 27; // Length of "[Add your personal note here]"
            textarea.setSelectionRange(placeholderStart, placeholderEnd);
            textarea.focus();
            
            updateCharCounter();
            haptic('light');
        }

        function resetTemplate() {
            const textarea = document.getElementById('templateTextarea');
            if (!textarea) return;
            
            if (confirm('Reset to the original template? Your changes will be lost.')) {
                textarea.value = originalTemplate;
                currentTask.emailTemplate = originalTemplate;
                updateCharCounter();
                haptic('medium');
            }
        }

        function previewTemplate() {
            const textarea = document.getElementById('templateTextarea');
            if (!textarea) return;
            
            isPreviewing = !isPreviewing;
            const previewContainer = document.querySelector('.preview-mode');
            
            if (isPreviewing && !previewContainer) {
                const previewHTML = `
                    <div class="preview-mode">
                        <div class="preview-header">Preview</div>
                        <div class="preview-content">${textarea.value}</div>
                    </div>
                `;
                document.querySelector('.template-tips').insertAdjacentHTML('afterend', previewHTML);
                document.querySelector('.quick-add-btn:last-child').textContent = 'Hide Preview';
            } else if (previewContainer) {
                previewContainer.remove();
                document.querySelector('.quick-add-btn:last-child').textContent = 'Preview';
            }
            
            haptic('light');
        }

        function makeCall() {
            window.location.href = `tel:${currentTask.phone}`;
            setTimeout(() => {
                completeTask();
            }, 1000);
        }

        function completeTask() {
            // Track editing behavior silently in background
            if (isEditing) {
                const textarea = document.getElementById('templateTextarea');
                const wasActuallyEdited = textarea && textarea.value !== originalTemplate;
                if (wasActuallyEdited) {
                    volunteerProfile.editCount++;
                } else {
                    volunteerProfile.sendWithoutEditCount++;
                }
            } else {
                volunteerProfile.sendWithoutEditCount++;
            }
            
            haptic('success');
            closeModal();
            
            document.getElementById('celebrationPoints').textContent = `+${currentTask.points} points`;
            document.getElementById('celebration').classList.add('active');

            setTimeout(() => {
                const pointsEl = document.getElementById('pointsValue');
                const completedEl = document.getElementById('completedValue');
                const weekEl = document.getElementById('weekValue');

                const currentPoints = parseInt(pointsEl.textContent);
                const currentCompleted = parseInt(completedEl.textContent);
                const currentWeek = parseInt(weekEl.textContent);

                tweenNumber(pointsEl, currentPoints + currentTask.points);
                tweenNumber(completedEl, currentCompleted + 1);
                tweenNumber(weekEl, currentWeek + 1);

                // Update volunteer level
                volunteerProfile.tasksCompleted++;

                pointsEl.style.transform = 'scale(1.2)';
                setTimeout(() => {
                    pointsEl.style.transform = 'scale(1)';
                }, 200);
            }, 500);

            setTimeout(() => {
                document.getElementById('celebration').classList.remove('active');
                
                // Show level up notification if they just unlocked editing
                if (volunteerProfile.tasksCompleted === 5) {
                    showLevelUpNotification();
                }
            }, 2000);
        }

        function showLevelUpNotification() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--text-primary);
                color: var(--surface);
                padding: 16px 24px;
                border-radius: 12px;
                font-size: 14px;
                font-weight: 600;
                z-index: 300;
                animation: slideUpFade 0.3s ease-out;
                max-width: 320px;
                text-align: center;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            `;
            notification.innerHTML = `
                🎉 Level Up!<br>
                <span style="font-weight: 400; font-size: 13px;">You can now edit email templates</span>
            `;
            document.body.appendChild(notification);
            
            haptic('success');
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Help System
        let helpArticlesData = [];

        function loadHelpArticles() {
            helpArticlesData = [
                {
                    id: 'what-is-vm',
                    category: 'Getting Started',
                    title: 'What is Volunteer Manager?',
                    desc: 'Learn about the platform and your role',
                    body: `
                        <h4>Welcome!</h4>
                        <p>Volunteer Manager helps you connect with donors and supporters through personalized outreach. As a volunteer, you'll complete quick tasks that make a real difference.</p>
                        <h4>Your Impact</h4>
                        <ul>
                            <li>Thank donors for their generosity</li>
                            <li>Follow up with prospects</li>
                            <li>Build lasting relationships with our community</li>
                        </ul>
                        <p>Each task you complete strengthens our school's fundraising efforts and shows donors how much we appreciate them.</p>
                    `
                },
                {
                    id: 'first-task',
                    category: 'Getting Started',
                    title: 'How do I complete my first task?',
                    desc: 'Step-by-step guide to getting started',
                    body: `
                        <h4>Step 1: Choose a Task</h4>
                        <p>Go to the Tasks tab and select any task from your list. We recommend starting with an email thank you.</p>
                        <h4>Step 2: Review Context</h4>
                        <p>Read the quick context about the donor - their giving history and key details.</p>
                        <h4>Step 3: Send or Customize</h4>
                        <p>Use the suggested template as-is, or click Edit to personalize it.</p>
                        <h4>Step 4: Hit Send</h4>
                        <p>Click "Send Email" and you're done! You'll earn points and see your progress update.</p>
                    `
                },
                {
                    id: 'edit-templates',
                    category: 'Tasks',
                    title: 'Can I edit email templates?',
                    desc: 'Learn about template editing permissions',
                    body: `
                        <h4>Editing Permissions</h4>
                        <p>Template editing unlocks after you complete 5 tasks. This ensures you're familiar with our messaging style first.</p>
                        <h4>When You Can Edit</h4>
                        <ul>
                            <li><strong>New volunteers (0-4 tasks):</strong> Templates are locked</li>
                            <li><strong>Intermediate (5-24 tasks):</strong> Can edit thank you emails</li>
                            <li><strong>Advanced (25+ tasks):</strong> Full editing freedom</li>
                        </ul>
                        <h4>Tips for Editing</h4>
                        <ul>
                            <li>Add personal details about the donor</li>
                            <li>Keep the professional tone</li>
                            <li>Stay under 800 characters</li>
                        </ul>
                    `
                },
                {
                    id: 'points-rewards',
                    category: 'Points & Rewards',
                    title: 'How do points and rewards work?',
                    desc: 'Understanding the points system',
                    body: `
                        <h4>Earning Points</h4>
                        <p>Each task you complete earns points based on difficulty:</p>
                        <ul>
                            <li>Email thank yous: 12-15 points</li>
                            <li>Phone calls: 10-15 points</li>
                            <li>Batch tasks: 20+ points</li>
                        </ul>
                        <h4>Unlocking Rewards</h4>
                        <p>Points unlock perks and milestones automatically:</p>
                        <ul>
                            <li>Template editing (5 tasks)</li>
                            <li>Advanced stats (10 tasks)</li>
                            <li>Profile themes (300 points)</li>
                        </ul>
                        <h4>Leaderboard</h4>
                        <p>Compete with other volunteers! The leaderboard resets weekly, so everyone has a fair chance.</p>
                    `
                },
                {
                    id: 'make-mistake',
                    category: 'Troubleshooting',
                    title: 'What if I make a mistake?',
                    desc: 'Don\'t worry - here\'s what to do',
                    body: `
                        <h4>Common Mistakes</h4>
                        <p><strong>Sent to wrong person:</strong> Contact your admin immediately with the task details.</p>
                        <p><strong>Typo in message:</strong> Most donors understand small errors. If it's significant, let your admin know.</p>
                        <p><strong>Completed wrong task:</strong> No problem - the system tracks everything correctly.</p>
                        <h4>Prevention Tips</h4>
                        <ul>
                            <li>Read the donor's name carefully before sending</li>
                            <li>Use Preview mode when editing templates</li>
                            <li>Double-check you're on the right task</li>
                        </ul>
                    `
                },
                {
                    id: 'contact-admin',
                    category: 'Troubleshooting',
                    title: 'How do I contact my admin?',
                    desc: 'Get help when you need it',
                    body: `
                        <h4>Admin Contact</h4>
                        <p>Go to your Profile → "My Admin" section to see your admin's contact information.</p>
                        <h4>When to Reach Out</h4>
                        <ul>
                            <li>You made a significant error on a task</li>
                            <li>Something seems wrong with donor information</li>
                            <li>You have questions about a specific campaign</li>
                            <li>Technical issues with the platform</li>
                        </ul>
                        <h4>Response Time</h4>
                        <p>Admins typically respond within 24 hours during business days.</p>
                    `
                },
                {
                    id: 'template-locked',
                    category: 'Tasks',
                    title: 'Why can\'t I edit this template?',
                    desc: 'Understanding template permissions',
                    body: `
                        <h4>Locked Templates</h4>
                        <p>Some templates are locked for all volunteers to ensure compliance and consistency.</p>
                        <h4>Reasons for Locking</h4>
                        <ul>
                            <li>Legal language required</li>
                            <li>Major gift solicitations</li>
                            <li>Institutional messaging</li>
                        </ul>
                        <h4>What You Can Do</h4>
                        <p>Even with locked templates, you can still add impact by completing tasks promptly and thoughtfully choosing when to send messages.</p>
                    `
                },
                {
                    id: 'task-complete',
                    category: 'Tasks',
                    title: 'What happens when I complete a task?',
                    desc: 'Understanding the task flow',
                    body: `
                        <h4>Immediate Effects</h4>
                        <ul>
                            <li>Message is sent to the donor</li>
                            <li>Points are added to your total</li>
                            <li>Task is marked complete</li>
                            <li>Your stats update automatically</li>
                        </ul>
                        <h4>Tracking</h4>
                        <p>All completed tasks are logged with:</p>
                        <ul>
                            <li>Timestamp of completion</li>
                            <li>Whether you edited the template</li>
                            <li>Donor response tracking (if applicable)</li>
                        </ul>
                        <h4>What's Next</h4>
                        <p>New tasks will appear in your queue automatically. Check back daily for fresh assignments!</p>
                    `
                }
            ];

            renderHelpArticles();
        }

        function renderHelpArticles(filter = '') {
            const content = document.getElementById('helpContent');
            const categories = {};

            // Group by category
            helpArticlesData.forEach(article => {
                // Filter by search
                if (filter && !article.title.toLowerCase().includes(filter.toLowerCase()) && 
                    !article.desc.toLowerCase().includes(filter.toLowerCase())) {
                    return;
                }

                if (!categories[article.category]) {
                    categories[article.category] = [];
                }
                categories[article.category].push(article);
            });

            let html = '';
            Object.keys(categories).forEach(category => {
                html += `
                    <div class="help-category">
                        <div class="help-category-title">${category}</div>
                `;
                categories[category].forEach(article => {
                    html += `
                        <div class="help-article" onclick="toggleHelpArticle('${article.id}')">
                            <div class="help-article-title">${article.title}</div>
                            <div class="help-article-desc">${article.desc}</div>
                            <div class="help-article-full" id="help-${article.id}">
                                <div class="help-article-body">${article.body}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            });

            if (html === '') {
                html = '<p style="text-align: center; color: var(--text-secondary); padding: 40px 20px;">No articles found. Try a different search term.</p>';
            }

            content.innerHTML = html;
        }

        function toggleHelpArticle(id) {
            const article = document.getElementById(`help-${id}`);
            const isActive = article.classList.contains('active');
            
            // Close all others
            document.querySelectorAll('.help-article-full').forEach(a => a.classList.remove('active'));
            
            // Toggle this one
            if (!isActive) {
                article.classList.add('active');
            }
            
            haptic('light');
        }

        function filterHelpArticles(value) {
            renderHelpArticles(value);
        }

        function toggleHelp() {
            const panel = document.getElementById('helpPanel');
            const overlay = document.getElementById('helpOverlay');
            const isActive = panel.classList.contains('active');

            if (isActive) {
                panel.classList.remove('active');
                overlay.classList.remove('active');
            } else {
                panel.classList.add('active');
                overlay.classList.add('active');
            }

            haptic('light');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            setTimeout(() => {
                document.getElementById('modalOverlay').classList.remove('active');
                isEditing = false;
            }, 300);
        }

        function openFullProfile(taskId) {
            const profile = taskData[taskId];
            
            document.getElementById('modalTitle').textContent = profile.name;
            
            const content = `
                <div style="display: flex; gap: 16px; margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid var(--border);">
                    <div style="width: 72px; height: 72px; background: var(--muted); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 700; color: var(--text-secondary); flex-shrink: 0;">${profile.initials}</div>
                    <div style="flex: 1;">
                        <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 4px;">${profile.name}</h2>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">${profile.role}</p>
                        <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                            ${profile.tags.map((tag, i) => `<span style="padding: 4px 8px; background: ${i === 0 ? '#eff6ff' : 'var(--muted)'}; color: ${i === 0 ? '#1e40af' : 'var(--text-secondary)'}; border-radius: 6px; font-size: 11px; font-weight: 600;">${tag}</span>`).join('')}
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); margin-bottom: 16px;">Contact Information</h3>
                    <div style="display: grid; gap: 16px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="font-size: 13px; color: var(--text-secondary); font-weight: 500;">Email</span>
                            <span style="font-size: 14px; font-weight: 600;">${profile.email}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="font-size: 13px; color: var(--text-secondary); font-weight: 500;">Phone</span>
                            <span style="font-size: 14px; font-weight: 600;">${profile.phone}</span>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); margin-bottom: 16px;">Giving Summary</h3>
                    <div style="display: grid; gap: 16px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="font-size: 13px; color: var(--text-secondary); font-weight: 500;">Lifetime Total</span>
                            <span style="font-size: 14px; font-weight: 600;">${profile.stats.lifetime}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="font-size: 13px; color: var(--text-secondary); font-weight: 500;">This Year</span>
                            <span style="font-size: 14px; font-weight: 600;">${profile.stats.thisYear}</span>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); margin-bottom: 16px;">Recent Gifts</h3>
                    ${profile.giving.map(gift => `
                    <div style="background: var(--muted); border-radius: 12px; padding: 16px; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="font-size: 24px; font-weight: 700;">${gift.amount}</span>
                            <span style="font-size: 12px; color: var(--text-secondary);">${gift.date}</span>
                        </div>
                        <div style="font-size: 13px; color: var(--text-secondary);">
                            <strong>${gift.campaign}</strong><br>
                            ${gift.designation}
                        </div>
                    </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalFooter').innerHTML = `
                <button class="btn btn-secondary btn-full btn-large" onclick="closeModal()">Close</button>
                <button class="btn btn-full btn-large" onclick="openTask('${taskId}', '${profile.type}')">Back to Task</button>
            `;
        }
    </script>
</body>
</html>